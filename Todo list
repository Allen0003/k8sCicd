
momo

docker image è¦å…¨å°å¯«

dockerfile backend è¦ä¸€å€‹  frontend ä¹Ÿè¦ä¸€å€‹

ä¸Ÿä¸Šgithub action build imageè¦è‡ªå‹•å†ä¸Ÿåˆ° GHCR éœ€è¦éº»ç…©token

github image è½‰ public https://github.com/Allen0003?tab=packages

frontend ç›´æ¥ä¸Ÿæˆéœæ…‹ç¶²é ä¸Šå»

render api key ä¸Ÿåˆ° github action


frontend å¦‚æœç”¨æˆ image

å‰ç«¯æ”¹ç‚º Web Serviceï¼ˆä½¿ç”¨ Docker imageï¼‰
 å¯ä»¥æ¨¡æ“¬æœªä¾†ç”¨ Kubernetes å¤šå®¹å™¨æ¶æ§‹



Backend

    Build JAR

    Build Docker Image

    Push åˆ° GitHub Container Registry

    è§¸ç™¼ Render å¾Œç«¯éƒ¨ç½² Hook

Frontend

    Build Angular App

    Build Docker Imageï¼ˆå« Nginxï¼‰ï¼ˆéœæ…‹ï¼‰

    Push åˆ° GitHub Container Registry

    è§¸ç™¼ Render å‰ç«¯éƒ¨ç½² Hook




cicd demo
commit ä¹‹å¾Œè§¸ç™¼ github action è‡ªå‹•é€²è¡Œæ¸¬è©¦ï¼Œ
è‡ªå‹•é€²è¡Œbuild è·Ÿ è‡ªå‹•ç”¢ç”Ÿimage
è‡ªå‹•æ›´æ–° render (Deploy Hook)

ä»¥ä¸Šæ˜¯ .github/workflows/ci.yml çš„è¨­å®š


//free service
https://dashboard.render.com/


ä»¥ä¸‹æ˜¯hello world
https://tsmcspringdemo-latest.onrender.com/hello


Git push
â†“
GitHub Actions
â”œâ”€â”€ mvn test
â”œâ”€â”€ docker build
â”œâ”€â”€ docker push ghcr.io/allen0003/tsmcspringdemo:latest
â””â”€â”€ curl -X POST <Render webhook>
â†“
Render æ‹‰æœ€æ–° image â†’ deploy
â†“
ä½ åœ¨ç¶²å€æ¸¬è©¦ â†’
https://tsmcspringdemo-latest.onrender.com/hello

åŠ ä¸Šæ¸¬è©¦å ±å‘Š jacoco pom + åƒæ•¸å³å¯



git hub build status
https://github.com/Allen0003/tsmcSpringDemo/actions/runs/16315115799

render home page
https://dashboard.render.com/web/srv-d1nqn8jipnbc73b13a2g/settings


TODO:

1. åŠ  Postgres é€£ç·šæ¸¬è©¦
2. åŠ å‰ç«¯ CI/CDï¼ˆä¾‹å¦‚ Angularï¼‰ï¼ˆä¸€æ¨£ç”¨æˆéœæ…‹ç¶²é ï¼‰
2.1 ééœæ…‹ç¶²é  Next.jsï¼ˆSSRï¼‰ ï¼ˆé‚„æ²’ï¼‰

2. å‰å¾Œç«¯è‡ªå‹•æ¸¬è©¦ ï¼ˆé‚„æ²’ï¼‰

3. å‰å¾Œç«¯æ•´åˆæˆå¤šå®¹å™¨ Docker Compose  (åˆ°é€™é‚Š ç„¶å¾Œ å‰ç«¯è¦æ”¹æˆç”¨ image + web service)
4. è½‰é€² Kubernetes
   i. æŠŠ docker-compose.yml æ‹†æˆ K8s çš„ Deployment + Service YAML
   ii. æ¯å€‹ componentï¼ˆå‰ç«¯ / å¾Œç«¯ / DBï¼‰éƒ½åšæˆ Pod

è‹¥è¦ç·´ç¿’éƒ¨ç½²ï¼Œå¯ç”¨ï¼š

    æœ¬åœ°ï¼šMinikube / Kind

    é›²ç«¯ï¼šRenderï¼ˆæœ‰é™æ”¯æ´ï¼‰ã€Railwayã€GKEã€Koyebã€Fly.io

å†é…ä¸Š GitHub Actions push .yaml è‡ªå‹• apply



ä½ å¯ä»¥å‘Šè¨´æˆ‘ä»¥ä¸‹ä»»ä¸€å€‹ï¼Œæˆ‘å¯ä»¥å¸¶ä½ å¾€ä¸‹ä¸€æ­¥èµ°ï¼š

1. å‰å¾Œç«¯ä¹‹é–“æ€éº¼ä¸² APIï¼ˆä¾‹å¦‚å‰ç«¯å‘¼å«å¾Œç«¯ /api/usersï¼‰

2. è¦éƒ¨ç½²é€™å€‹ Docker Compose åˆ° Renderï¼ˆä½† Render ä¸æ”¯æ´ Docker Composeï¼Œæˆ‘å¯ä»¥æ•™ä½ æ”¹æˆ Kubernetes æˆ–æ‹†é–‹éƒ¨ç½²ï¼‰


âœ… å¤šå®¹å™¨ CI/CD æ¶æ§‹ï¼ˆç¸½è¦½ï¼‰

ä½ çš„æƒ…å¢ƒï¼š

    å‰ç«¯ï¼ˆAngularï¼‰â¡ï¸ Build æˆéœæ…‹ç¶²é  â¡ï¸ æ”¾å…¥ Nginx Docker image

    å¾Œç«¯ï¼ˆSpring Bootï¼‰â¡ï¸ Build æˆ .jar â¡ï¸ æ”¾å…¥ JDK Docker image

    ç”¨ Docker Compose æ•´åˆå…©è€…

    Push åˆ° GitHub Container Registryï¼ˆæˆ– Docker Hubï¼‰

    Trigger Render æˆ–å…¶ä»–å¹³å°éƒ¨ç½²



âœ… æ¸¬è©¦éšæ®µ  åŠ å…¥å–®å…ƒæ¸¬è©¦ã€e2e æ¸¬è©¦   å‰ç«¯å¯ç”¨ ng test, å¾Œç«¯ç”¨ JUnit
âœ… åˆ†ç’°å¢ƒéƒ¨ç½² å€åˆ† staging å’Œ production åˆ†æ”¯  push åˆ°ä¸åŒåˆ†æ”¯ï¼Œéƒ¨ç½²åˆ°ä¸åŒæœå‹™
âœ… è‡ªå‹•åŒ–é€šçŸ¥ éƒ¨ç½²æˆåŠŸå¾Œé€šçŸ¥ Slack/Line/email    åŠ ä¸€å€‹ curl webhook é€é€šçŸ¥




-------------------k8s ä¹‹å‰å¤šå®¹å™¨åŒ–å®Œæ•´ç‰ˆæœ¬

ğŸ§  ä½ ç›®å‰çš„ CI/CD èƒ½åŠ›åŒ…å«ï¼š
èƒ½åŠ›  ç‹€æ…‹
âœ… å¤šå®¹å™¨æ”¯æ´ å‰å¾Œç«¯å„è‡ªæ‰“åŒ…ã€éƒ¨ç½²
âœ… è‡ªå‹•å»ºæ§‹ Docker image å…©é‚Šéƒ½è‡ªå‹• build
âœ… è‡ªå‹•éƒ¨ç½²  Render webhook trigger
âœ… ç§æœ‰ image æ¨é€   ä½¿ç”¨ GHCR + Secret
âœ… ç¨ç«‹å®¹å™¨éƒ¨ç½²    å‰å¾Œç«¯åœ¨ Render å„è‡ªæœå‹™è·‘ Docker å®¹å™¨

